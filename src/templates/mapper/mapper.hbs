import { Injectable } from "@nestjs/common";
import { {{entityNamePascal}}Entity } from "@modules/{{moduleNameKebab}}/domain/entities/{{entityNameKebab}}.entity";
import { {{entityNamePascal}}OrmEntity } from "@modules/{{moduleNameKebab}}/infrastructure/orm-entities/{{entityNameKebab}}.orm-entity";
import { {{entityNamePascal}}ResponseDto } from "@modules/{{moduleNameKebab}}/application/dto/responses/{{entityNameKebab}}.response.dto";

@Injectable()
export class {{entityNamePascal}}Mapper {
  toDomainEntity(ormEntity: {{entityNamePascal}}OrmEntity): {{entityNamePascal}}Entity {
    if (!ormEntity) {
      throw new Error("ORM entity is required");
    }

    return new {{entityNamePascal}}Entity({
      id: ormEntity.id,
      isActive: ormEntity.isActive,
      createdAt: ormEntity.createdAt,
      updatedAt: ormEntity.updatedAt,
      deletedAt: ormEntity.deletedAt,
      // Map additional fields from ORM entity (snake_case) to domain entity (camelCase)
      {{#each fields}}
      {{this.camelCase}}: ormEntity.{{this.snakeCase}},
      {{/each}}
    });
  }

  toOrmEntity(domainEntity: {{entityNamePascal}}Entity): Partial<{{entityNamePascal}}OrmEntity> {
    if (!domainEntity) {
      throw new Error("Domain entity is required");
    }

    const ormEntity: Partial<{{entityNamePascal}}OrmEntity> = {
      id: domainEntity.id,
      isActive: domainEntity.isActive,
      createdAt: domainEntity.createdAt,
      updatedAt: domainEntity.updatedAt,
      deletedAt: domainEntity.deletedAt,
      // Map additional fields from domain entity (camelCase) to ORM entity (snake_case)
      {{#each fields}}
      {{this.snakeCase}}: domainEntity.{{this.camelCase}},
      {{/each}}
    };

    return ormEntity;
  }

  toResponseDto(entity: {{entityNamePascal}}Entity): {{entityNamePascal}}ResponseDto {
    return new {{entityNamePascal}}ResponseDto({
      id: entity.id,
      isActive: entity.isActive,
      createdAt: entity.createdAt,
      updatedAt: entity.updatedAt,
      // Map additional fields for response
      {{#each fields}}
      {{this.camelCase}}: entity.{{this.camelCase}},
      {{/each}}
    });
  }

  toResponseDtoList(entities: {{entityNamePascal}}Entity[]): {{entityNamePascal}}ResponseDto[] {
    return entities.map((entity) => this.toResponseDto(entity));
  }
}
